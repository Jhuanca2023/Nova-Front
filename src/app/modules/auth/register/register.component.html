<div class="min-h-screen flex items-center justify-center p-4 bg-base-200">
  <div class="max-w-md w-full">
    <div class="card bg-base-100 shadow-xl overflow-hidden">
      <div class="card-body p-8 relative">
        <div class="text-center mb-6">
          <h2 class="text-3xl font-bold">NeonNova</h2>
          <p class="text-sm text-muted-foreground mt-2">Crear una cuenta</p>
        </div>

        <register-form-stepper [currentStep]="currentStep()"/>

        @if (registerError()) {
          <div class="alert alert-error mb-6 animate-fade-in">
            <lucide-angular name="alert-circle" class="w-5 h-5"></lucide-angular>
            <span>{{ registerError() }}</span>
          </div>
        }

        <form
          [formGroup]="registerForm"
          (ngSubmit)="register()"
          class="space-y-6 relative form-container"
        >
          <div
            #formStep1
            class="form-step transition-all"
            [class.form-step-active]="currentStep() === 1"
            [class.form-step-exit]="
              isAnimating() && slideDirection() === 'next'
            "
            [class.form-step-previous]="currentStep() !== 1 && !isAnimating()"
          >
            <personal-info-form [parentForm]="registerForm"/>
          </div>

          <div
            #formStep2
            class="form-step transition-all"
            [class.form-step-active]="currentStep() === 2"
            [class.form-step-next]="
              currentStep() !== 2 &&
              slideDirection() === 'next' &&
              !isAnimating()
            "
            [class.form-step-enter]="
              isAnimating() && slideDirection() === 'next'
            "
          >
            <register-credentials-form
              [parentForm]="registerForm"
              [isPasswordVisible]="isPasswordVisible()"
              [isConfirmPasswordVisible]="isConfirmPasswordVisible()"
              [passwordStrength]="passwordStrength()"
              [passwordRequirements]="passwordRequirements()"
              [termsAccepted]="termsAccepted()"
              (togglePassword)="togglePasswordVisibility()"
              (toggleConfirmPassword)="toggleConfirmPasswordVisibility()"
              (toggleTerms)="toggleTermsAccepted()"
            />
          </div>

          <!-- Botones de navegación entre pasos -->
          <div class="flex justify-between mt-6">
            @if (currentStep() > 1) {
              <button
                type="button"
                class="btn btn-outline"
                (click)="prevStep()"
                [disabled]="isAnimating()"
              >
                Atrás
              </button>
            } @else {
              <div></div>
            }
            @if (currentStep() < 2) {
              <button
                type="button"
                class="btn btn-primary"
                (click)="nextStep()"
                [disabled]="isAnimating()"
              >
                Siguiente
              </button>
            } @else {
              <button
                type="submit"
                class="btn btn-primary submit-button"
                [disabled]="
                registerForm.invalid || isRegistering() || isAnimating()
              "
              >
                @if (isRegistering()) {
                  <span class="loading loading-spinner loading-xs"></span>
                  Registrando...
                } @else {
                  Crear cuenta
                }
              </button>
            }
          </div>
        </form>

        <div class="text-center mt-6">
          <p class="text-sm text-muted-foreground">
            ¿Ya tienes una cuenta?
            <a
              routerLink="/auth/login"
              class="text-primary font-medium hover:underline"
            >
              Iniciar sesión
            </a>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
