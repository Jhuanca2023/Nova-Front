<section class="py-12">
  <div class="container mx-auto px-4">
    <div class="text-center mb-10">
      <h2 class="text-3xl font-bold tracking-tight">Productos Destacados</h2>
      <p class="mt-4 text-lg text-muted-foreground">
        Descubre nuestra selección de productos más populares y mejor valorados
      </p>
    </div>

    <!-- Estado de carga -->
    @if (productsResource.isLoading()) {
    <div class="flex justify-center py-12">
      <div class="loading loading-spinner loading-lg text-primary"></div>
    </div>
    } @else if (featuredProducts().length === 0) {
    <!-- Estado vacío -->
    <div class="text-center py-12">
      <p class="text-muted-foreground">
        No hay productos destacados disponibles en este momento.
      </p>
    </div>
    } @else {
    <div #productCarousel class="relative mb-16">
      <!-- Contenedor del carrusel -->
      <div class="overflow-hidden mx-auto max-w-7xl">
        <div class="carousel-container">
          <div
            class="carousel-group"
            [style.transform]="'translateX(-' + currentSlide() * 100 + '%)'"
          >
            <!-- Grupos de productos por slide -->
            @for (slideIndex of slideIndicators; track slideIndex) {
            <div class="product-slide">
              @for (product of getSlideProducts(slideIndex); track product.id) {
              <div class="product-item visible">
                <product-card [product]="product"></product-card>
              </div>
              }
            </div>
            }
          </div>
        </div>
      </div>

      <!-- Botones de navegación -->
      <button
        (click)="prevSlide()"
        class="btn btn-circle btn-primary fixed-nav-btn left-0 md:-left-4"
        [disabled]="currentSlide() === 0"
        [class.opacity-50]="currentSlide() === 0"
        aria-label="Anterior"
      >
        <lucide-angular
          name="chevron-left"
          class="w-6 h-6"
        ></lucide-angular>
      </button>

      <button
        (click)="nextSlide()"
        class="btn btn-circle btn-primary fixed-nav-btn right-0 md:-right-4"
        [disabled]="currentSlide() === totalSlides - 1"
        [class.opacity-50]="currentSlide() === totalSlides - 1"
        aria-label="Siguiente"
      >
        <lucide-angular
          name="chevron-right"
          class="w-6 h-6"
        ></lucide-angular>
      </button>

      <!-- Indicadores -->
      <div
        class="flex justify-center mt-8 space-x-2 absolute bottom-[-40px] left-0 right-0"
      >
        @for (indicator of slideIndicators; track indicator) {
        <button
          (click)="goToSlide(indicator)"
          class="w-3 h-3 rounded-full transition-colors duration-200 cursor-pointer "
          [class.bg-primary]="currentSlide() === indicator"
          [class.bg-gray-300]="currentSlide() !== indicator"
          [attr.aria-label]="'Ir a slide ' + (indicator + 1)"
        ></button>
        }
      </div>
    </div>
    }

    <div class="text-center mt-16">
      <a routerLink="/products" class="btn btn-outline btn-wide">
        Ver todos los productos
      </a>
    </div>
  </div>
</section>
